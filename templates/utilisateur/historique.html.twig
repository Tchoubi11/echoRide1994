{% extends 'base.html.twig' %}

{% block title %}Historique de mes trajets{% endblock %}

{% block body %}
<div class="container mt-5">
    <h2>ğŸ“š Historique de mes covoiturages</h2>

    <h3 class="mt-4">ğŸš— En tant que conducteur</h3>
    {% if covoiturages is not empty %}
        {% for covoiturage in covoiturages %}
            <div class="card p-3 mb-3 shadow-sm">
                <strong>{{ covoiturage.lieuDepart }} â†’ {{ covoiturage.lieuArrivee }}</strong><br>
                DÃ©part : {{ covoiturage.dateDepart|date('d/m/Y H:i') }}<br>

                {% if covoiturage.isCancelled %}
                    <span class="badge bg-danger mt-2">ğŸš« AnnulÃ©</span>
                {% elseif covoiturage.isCompleted %}
                    <span class="badge bg-success mt-2">âœ… TerminÃ©</span>
                    <p class="text-muted mb-0">ArrivÃ© Ã  {{ covoiturage.endAt|date('d/m/Y H:i') }}</p>
                {% else %}
                    <span class="badge bg-warning mt-2">ğŸ•’ Non terminÃ©</span>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">Aucun trajet en tant que conducteur.</p>
    {% endif %}

    <h3 class="mt-4">ğŸ§ En tant que passager</h3>
    {% if reservations is not empty %}
        {% for res in reservations %}
            <div class="card p-3 mb-3 shadow-sm">
                <strong>{{ res.covoiturage.lieuDepart }} â†’ {{ res.covoiturage.lieuArrivee }}</strong><br>
                DÃ©part : {{ res.covoiturage.dateDepart|date('d/m/Y H:i') }}<br>

                {% if res.covoiturage.isCancelled %}
                    <span class="badge bg-danger mt-2">âŒ Trajet annulÃ©</span>
                {% elseif res.covoiturage.isCompleted %}
                    <span class="badge bg-success mt-2">âœ… TerminÃ©</span>
                    <p class="text-muted mb-0">ArrivÃ© Ã  {{ res.covoiturage.endAt|date('d/m/Y H:i') }}</p>
                {% else %}
                    <span class="badge bg-warning mt-2">ğŸ•’ Ã€ venir ou en cours</span>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">Aucune rÃ©servation en tant que passager.</p>
    {% endif %}

    <div class="mt-4 d-flex flex-wrap justify-content-start gap-3">
        <a href="{{ path('user_profile') }}" class="btn btn-secondary">ğŸ‘¤ Retour au profil</a>
        <a href="{{ path('app_home') }}" class="btn btn-primary">ğŸ  Accueil</a>
        <a href="{{ path('espace_utilisateur') }}" class="btn btn-secondary">âš™ï¸ Retour sur mon espace utilisateur</a>
    </div>
    
</div>
{% endblock %}
